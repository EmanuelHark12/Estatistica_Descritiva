---
title: "Lista 1 - MAE0127 -  Prof Julio Singer"
author: 
 - Alexandre Felix da Silva 11221435 Eduardo Janotti Cavalcanti 11221481
 - Emanuel Hark Maciel 11221380 Emerson Silva Aragão 11371583 Guilherme Yukio Iasunaga 11218195
 - Pedro Henrique Gallo Andrade 11221550 William Silva Veçoso 10801513
date: "26/03/2020"
output:
  pdf_document: 
    latex_engine: xelatex
header-includes:
- \usepackage{graphicx}
- \usepackage[utf8]{inputenc}
- \usepackage{amssymb}
- \usepackage{amsmath}
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Capítulo 2

## Exercício 4

A Tabela abaixo contém uma planilha encaminhada pelos investigadores responsáveis por unm estudo sobre AIDS para análise estatística. Organize-a de forma a permitir sua análise por meio de um pacote computacional como o R.

\center
\begin{tabular}{ccccc}
\hline
\textbf{Grupo I} & \textbf{Tempo de}  & & & \textbf{Ganho de Peso} \\ 
\textbf{registro}& \textbf{Diagnstico} & \textbf{DST} & \textbf{MAC} & \textbf{por Semana} \\ \hline
2847111D & pre natal & nao                & Pilula & 11Kg em 37 semanas  \\
3034048F & 6 meses   & nao                & pilula & ?                   \\
3244701J & 1 ano     & nao                & Condon & ?                   \\
2943791B & pre natal & nao                & nao    & 8 Kg em 39 semanas  \\
3000327F & 4 anos    & condiloma/ sifilis & nao    & 9Kg em 39 semanas   \\
3232893D & 1 ano     & nao                & DIU    & 3Kg em 39 semanas   \\
3028772E & 3 anos    & nao                & nao    & 3 kg em 38 semanas  \\
3240047G & pre natal & nao                & pilula & 9 Kg em 38 semanas  \\
3017222G &           & HPV                & CONDON & falta exame clinico \\
3015834J & 2 anos    & nao                & condon & 14 Kg em 40 semanas \\ \hline
\textbf{Grupo I} & \textbf{Tempo de}  & & & \textbf{Ganho de Peso} \\ 
\textbf{registro}& \textbf{Diagnstico} & \textbf{DST} & \textbf{MAC} & \textbf{por Semana} \\ \hline
3173611E & 3 meses & abcesso ovariano & condon & 15 Kg em 40 semanas \\
3296159D & pre natal & nao & condon & 0 Kg em ? semanas \\
3147820D1 & 2 anos & nao & sem dados & 4 Kg em 37 semanas \\
3274750K & 3 anos & nao & condon & 8 Kg em 38 semanas \\
3274447H & pre natal & sifilis com 3 meses& condon & \\
2960066D & 5 anos & nao & ? & 13 Kg em 36 semanas \\
3235727J & 7 anos & nao & Condon & (-) 2 Kg em 38 semanas \\
3264897E & & condiloma & condon & nenhum Kg \\
3044120J & 5 anos & HPV & & 3 Kg em 39 semanas 1 \\ \hline
\end{tabular}
\medskip

Planilha com dados de um estudo sobre AIDS. \

\raggedright


## Resolução
\raggedright
```{r,echo=FALSE}
library(xlsx)
library(knitr)
setwd("/home/emanuelhark/Documentos/Descritiva/Lista1")
dados_lista1_4 <- read.xlsx('Dados questão 4.xlsx',2,  colClasses=c('character','character','numeric','character','numeric','numeric','numeric','numeric'))
names(dados_lista1_4) <- c('grupo','reg','tempo','dst','mac','gansem','gantot','sem')
attach(dados_lista1_4)
df_lista1_4 <- data.frame(dados_lista1_4)
names(df_lista1_4) <- c('grupo','reg','tempo','dst','mac','gansem','gantot','sem')
knitr::kable(df_lista1_4)
```

Nós escolhemos classificar pré-natal = 0, a variável dst como binária e nac como categórica.
Com os devidos rótulos:

\begin{table}[]
\centering
\caption{Rótulos da planilha de un estudo sobre AIDS}
\begin{tabular}{lll}
\hline
\textbf{Rótulos} & \textbf{Variável} & \textbf{Unidade de Medida} \\ \hline
grupo & Número de grupo em que o paciente foi observado & \\
reg & Registro da identificação do paciente & \\
tempo & Tempo de diagnóstico do teste sobre DST & meses \\
dst & Presença de doenças sexualmente transmissíveis  & 0: Falso \\
& (HPV/AIDS/condiloma/sifílis)& 1: Verdadeiro \\
mac & Método anticonceptivo do paciente & 0: Não \\
& & 1: Condon \\
& & 2: Pílula \\
& & 3: DIU \\
gansem & Ganho de peso por semana & Kg/Semana \\
gantot & Ganho de peso total & Kg \\
sem & Semana no qual o ganho do peso foi vistoriado & semana \\ \hline
Obs: & Observações omissas são representadas por 'NA' & \\ \hline
\end{tabular}
\end{table}

\raggedright

## Exercício 5


Num estudo planejado para avaliar o consumo médio de combustı́vel de veı́culos em diferentes velocidades foram utilizados 4 automóveis da marca A e 3 automóveis da marca B selecionados ao acaso das respectivas linhas de produção. O consumo (em L/km) de cada um dos 7 automóveis foi observado em 3 velocidades diferentes (40 km/h,80 km/h e 110 km/h). Construa uma tabela apropriada para a coleta e análise estatı́stica dos dados, rotulando-a adequadamente.                     

## Resolução
```{r,echo=F}

library(knitr)
library(kableExtra)

setwd("/home/emanuelhark/Documentos/Descritiva/Lista1")
dados_lista_5 <- read.csv('dados_quest5.csv')
names(dados_lista_5) <- c('marca','carro','consp','consm','consa')
attach(dados_lista_5)
df_lista1_5 <- data.frame(matrix(c(marca,carro,consp,consm,consa),7,5))
names(df_lista1_5) <- c('Marca','Carro','Pequeno','Médio','Alto')
dt<- kable(df_lista1_5,booktabs=T) %>%
  add_header_above(c('','','Consumo'=3)) %>%
  kable_styling(latex_options = 'striped')
dt
```

Com os devidos rótulos

\begin{table}[]
\centering
\caption{Rótulos da planiha de consumo de carros}
\begin{tabular}{lll}
\hline
\textbf{Rótulos} & \textbf{Variável} & \textbf{Unidade de Medida} \\ \hline
marca & identificador da marca do carro & 0: Marca A \\
 & & 1: Marca B \\
carro & identificador do carro medido & \\
Consumo Pequeno & Consumo de combústivel do carro em pequena velocidade (40km/h) & L/Km \\
Consumo Médio & Consumo de combústivel do carroem média velocidade (80Km/h) & L/Km \\
Consumo Alto & Consumo de combustível do carro  em alta velocidade (110 Km/h) & L/Km \\ \hline
Obs: & Observações omissas são representadas por NA & \\ \hline
\end{tabular}
\end{table}


\center
\begin{figure}
  \includegraphics{grapico6.png}
  \caption{Limiar auditivo de pacientes observados em 3 ocasiões.}
  \label{fig:Limiar auditivo de pacientes observados em 3 ocasiões.}
\end{figure}

\raggedright

## Exercício 6


A planilha apresentada na Figura 2.7 contém dados de um estudo em que o limiar auditivo foi avaliado nas orelhas direita (OD) e esquerda (OE) de 13 pacientes em 3 ocasiôes (Limiar, Teste 1 e Teste 2). Reformate-a segundo as recomendações da Seção 2.3


\raggedright
## Resolução

```{r,echo=FALSE}
library(knitr)
library(xlsx)
library(magrittr)
library(kableExtra)
setwd("/home/emanuelhark/Documentos/Descritiva/Lista1")
dados_lista1_6 <- read.xlsx('Dados questão 4.xlsx',4,check.names=T,colClasses = c('character','numeric','numeric','numeric','numeric','numeric','numeric'))
names(dados_lista1_6) <- c('id','Direito(%)','Esquerdo(%)','Direito(%)','Esquerdo(%)','Direito(%)','Esquerdo(%)')
attach(dados_lista1_6)
dt <- kable(dados_lista1_6,booktabs=T) %>%
  add_header_above(c('','Limiar'=2,'Teste 1' = 2, 'Teste2' = 2)) %>%
  add_header_above(c('','Olho'=2,'Olho'=2,'Olho'=2)) %>%
  kable_styling(latex_options = 'striped')
dt

```

Nós escolhemos arrendondar as unidades, em porcentagem, com dois números significativos.

\newpage

# Capítulo 3

## Exercício 1

O arquivo \textit{rehabcardio} contém informações sobre um estudo de reabilitação de pacientes cardíacos. Elabore um relatório indicando possíveis inconsistências na matriz de dados e faça uma análise descritiva de todas as variáveis do estudo.

## Resolução

```{r,echo=FALSE}
library(xlsx)
setwd("/home/emanuelhark/Documentos/Descritiva/Lista1")
dados_lista1_1 <- read.xlsx('rehabcardio.xlsx',1,colClasses = c('numeric','character','character','character','Date','Date','Date','numeric','character','character','character','numeric','numeric','character','character','character','numeric','numeric','numeric','numeric','numeric','numeric','numeric','character','character','character','character','character','character','character','character','character','numeric','numeric','character','character','character','character','Date','character','Date','Date','Date','Date'))
attach(dados_lista1_1)
```

### Variável qualitativa

```{r,echo=FALSE}
library(knitr)
library(magrittr)
library(kableExtra)
abc <- function(y,z,t,u){
  x <- summary(y)
  if (length(x) < 3){
    nomes <- c(z,t)
    frequencia <- c(x[1],x[2])
    freqrelat <- c(format(round(x[1]/(x[1]+x[2])* 100, 0), nsmall = 0),format(round(x[2]/(x[1]+x[2])* 100, 0), nsmall = 0))
    freqrelabs <- c(format(round(x[1]/(x[1]+x[2])* 100, 0), nsmall = 0),100)
    dfa <- data.frame(nomes,frequencia,freqrelat,freqrelabs)
    names(dfa) <- c(u,'Frêquencia observada','Frêquencia relativa (%)', 'Frequência acumulada(%)')
    tba <- kable(dfa,booktabs=F,caption = sprintf("Distribuição de frequência %s",u),'latex') %>%
      kable_styling(latex_options =c("striped", "HOLD_position"),full_width = T,fixed_thead = TRUE) 
    tba
  }
  else{
    nomes <- c(z,t,'Não Observados')
    frequencia <- c(x[2],x[1],x[3])
    freqrelat <- c(format(round(x[2]/(x[1]+x[2]+x[3]) * 100,0),nsmall=0) ,                          format(round(x[1]/(x[1]+x[2]+x[3]) * 100,0),nsmall=0),format(round(x[3]/(x[1]+x[2]+x[3])*100,0),nsmall=0))
    freqrelabs <- c(format(round(x[2]/(x[1]+x[2]+x[3]) * 100,0),nsmall = 0)
    ,format(round((x[2]/(x[1]+x[2]+x[3]))+(x[1]/(x[1]+x[2]+x[3])) * 100,0),nsmall = 0),100)
    dfa <- data.frame(nomes,frequencia,freqrelat,freqrelabs)
    names(dfa) <- c(u,'Frêquencia observada','Frêquencia relativa (%)', 'Frequência acumulada(%)')
    tba <- kable(dfa,booktabs=T,caption = sprintf("Distribuição de frequência %s",u),'latex') %>%
      kable_styling(latex_options =c("striped", "HOLD_position"),full_width = T,fixed_thead = TRUE) 
    tba
  }
}
```

```{r,echo=FALSE}
library(ggplot2)
library(kableExtra)
tab_genero <- abc(Genero,'Feminino','Masculino','Gênero')
tab_genero
res_genero <- summary(Genero)
generus <- c(res_genero[1],res_genero[2])
grupo <- c("Feminino","Mascuilino")
df_genero <- data.frame(generus)
bar_genero <- ggplot(df_genero,aes(x="",y=generus,fill=grupo)) + geom_bar(width = 1,stat="identity") + xlab("Gênero") + ylab("Quantidade de Pessoas") + ggtitle("Gráfico de Barras da variável Gênero") +  theme(plot.title = element_text(hjust = 0.5))
bar_genero
pie_genero <- bar_genero + coord_polar("y",start=0) + xlab("Gênero") + ylab("") + ggtitle("Gráfico do tipo 'pizza' da variável Gênero")
pie_genero
```

Percebe-se que há preferencialmente membros do sexo masculino dentro dessa amostra.

### Variável quantitativa discreta

```{r,echo=FALSE}
csa <- function(w){
  library(e1071)
  u <- summary(w)
  min <- as.numeric(u[1])
  quart1 <- as.numeric(u[2])
  median <- as.numeric(u[3])
  media <- as.numeric(u[4])
  quart2 <- as.numeric(u[5])
  max <- as.numeric(u[6])
  y <- table(w)
  moda <- names(y)[which(y==max(y))]
  na <- as.numeric(u[7])
  desvio <- sqrt(var(u,na.rm=TRUE))
  distancia <- as.numeric(u[5]-u[2])
  desvio_medio <- mad(w,center=mean(w),na.rm = TRUE)
  assis_fp <- skewness(w,na.rm =TRUE, type=1)
  assis_fpa <- skewness(w,na.rm = TRUE,type=2)
  assis_p2 <- skewness(w,na.rm=TRUE,type=3)
  kurtos <- skewness(w,na.rm=TRUE,type = 1)
  kurtose <- round(kurtos,digits=3)
  df <- data.frame(min,quart1,median,media,quart2,max,moda,desvio,desvio_medio,distancia,assis_fp,assis_fpa,assis_p2,kurtose,na)

  df
}
```

```{r,echo=FALSE,warning=FALSE,fig.width=4,fig.height=4}
library(kableExtra)
library(knitr)
library(magrittr)
library(ggplot2)
freq_lesoes <- table(Lesoes,useNA = c('ifany'))
df_lesoes <- data.frame('Nº de pacientes',freq_lesoes[1],freq_lesoes[2],freq_lesoes[3],freq_lesoes[4])
names(df_lesoes) <- c('Nº de lesões','1','2','3','NA')
tab_lesoes <- kable(df_lesoes,booktabs=T,caption = 'Número de ') %>%
  kable_styling(latex_options = c("striped",'HOLD_position'),full_width = TRUE)
tab_lesoes
quantil_lesoes <- quantile(Lesoes,seq.default(0,1,1/length(Lesoes)),na.rm = TRUE)
df2_lesoes <- data.frame(Lesoes)
bar_lesoes <- ggplot(na.omit(df2_lesoes),aes(x=Lesoes)) + geom_bar() + xlab('Lesões') + ylab('Quantidade de pessoas ') + ggtitle('Gráfico de barra da variável Lesões') + theme(plot.title = element_text(hjust = 0.5))
bar_lesoes

```

Como a variável Lesoes é discreta, nota-se que os números de pacientes decai com o aumento do número de lesões, mostrando um comportamento decrescente.

### Variável quantitativa contínua

```{r,echo=FALSE,fig.width=4,fig.height=4,warning=FALSE}
library(kableExtra)
library(knitr)
library(magrittr)
library(ggplot2)
library(data.table)
df_peso <- csa(Peso)
names(df_peso) <- c('Mínimo','1º Quartil','Mediana','3º Quartil','Média', 'Máxi- mo',"Moda",'Padrão','Médio',"Inter-quartil","Normal","Ajustado","Pearson 2","Kurtose","NA")
tab_peso <- kable(df_peso,booktabs=T,caption = 'Medidas de posição e de disperção da variável PESO ') %>%
  kable_styling(latex_options = c("striped",'HOLD_position','scale_down',"basic","condesed"),full_width = TRUE,fixed_thead = TRUE)  %>%
  add_header_above(c("","","","","","","","","","","Fisher Pearson"=2,"")) %>%
  add_header_above(c("","Quartis"=3,"","","","Desvio"=3,"Coeficientes de Assimetria"=3,"","")) %>%
  add_header_above(c("Resumo (Kg)"=7,"Dispersão(Kg)" = 3,"Assimetria" = 4,"")) 
tab_peso  
df2_peso <- data.frame(Peso)
classes_peso <- c('40,50','50-60','60-70','70-80','80-90','90-100','100-110','110-120',"NA","Total")
freq_peso <- c(5,42,80,119,86,29,11,3,6,381)
freqa_peso <- c(5,47,127,246,332,361,372,375,381,381)
freqr_peso <- c(1,11,21,31,22,8,3,1,2,100)
freqea_peso <- c(1,12,33,64,86,94,97,98,100,100)
df_freq <- data.frame(classes_peso,freq_peso,freqa_peso,freqr_peso,freqea_peso)
names(df_freq) <- c("Classes","Frequência","Frequência acumulada","Frequência relativa (%)","Frequência relativa acumulada (%)")
tabe_peso <- kable(df_freq,booktabs=T,caption = 'Distribuição da frequência da variável PESO ') %>%
  kable_styling(latex_options = c("striped",'HOLD_position'),full_width = TRUE,fixed_thead=TRUE)
tabe_peso  

hist_peso <- ggplot(na.omit(df2_peso),aes(x=Peso)) + geom_histogram(binwidth = 10) + ggtitle('Histograma da variável Peso') +  theme(plot.title = element_text(hjust = 0.5))
hist_peso 
box_peso <- ggplot(na.omit(df2_peso),aes(y=Peso)) + geom_boxplot() + ggtitle('Boxplot da variável Peso') +  theme(plot.title = element_text(hjust = 0.5))
box_peso
df3_peso <- data.frame(na.omit(Peso))
Pesos <- na.omit(Peso)
Pesos_z <- (Pesos - mean(Pesos))/sqrt(var(Pesos))
num_pes <- 1/length(Peso)
s_pes <- seq.default(0,1,num_pes)
plot(x=s_pes,y = quantile(Peso,seq.default(0,1,num_pes),na.rm = TRUE),xlab = "p",ylab = "Quantis da variável Peso",title("Gráfico de Quantis da variável Peso"))

tabe_peso <- table(Peso)

qq_peso <- ggplot(na.omit(df2_peso),aes(sample=na.omit(Pesos_z))) + stat_qq() + geom_abline(intercept = 0,slope = 1,linetype="dashed") + xlab("Quantis teóricos da distribuição N(0,1)") + ylab("Quantis padronizados do Peso ") + ggtitle(" qqplot da variável Peso") + theme(plot.title = element_text(hjust = 0.5))
qq_peso
```

Como a variável Peso é contínua, nota-se, pelos gráficos de histograma, de quantis e do qqplot com os quantis teóricos normais, que o comportamento do dados é aproximadanete normal, tendo três valores discrepantes superiores.

Nós não encontramos variáveis qualitativas ordinais.

## Exercício 6 

Considere do arquivo \textit{vento}. Observe o valor atípico 61,1, que na realidade ocorreu devido a forte tempestade no dia 2 de dezembro. Calcule as medidas de posição e dispersão dadas na Seção 3.3. Comente os resultados.

## Resolução

```{r,echo=FALSE,fig.width=4,fig.height=4,warning=FALSE}
library(knitr)
library(magrittr)
library(xlsx)
library(kableExtra)
setwd("/home/emanuelhark/Documentos/Descritiva/Lista1")
dados_lista1_62 <- read.xlsx("vento.xlsx",1,colClasses = c("numeric","numeric","numeric","numeric"))
attach(dados_lista1_62)
dados_vento <- data.frame(dados_lista1_62)
media_vt <- c(18.40)
mediana_vt <- c(14.80)
quartil1_vt <- c(9.25)
quartil3_vt <- c(21.30)
variancia_vt <- c(192.93)
desviopadrao_vt <- c(13.52)
desviomedio_vt <- c(8.76)
desviointer_vt <- c(12.05)
df_vento <- data.frame(media_vt,quartil1_vt,mediana_vt,quartil3_vt,variancia_vt,desviopadrao_vt,desviomedio_vt,desviointer_vt,row.names = c("Velocidade do Vento"))
names(df_vento) <- c("Média","1º Quartil","Mediana","3º Quartil","Variância","Desvio Padrão","Desvio Médio","Intervalo Interquartil")
tab_vento <- kable(df_vento,booktabs=T,caption = 'Medidas de posição e de disperção das variáveis vt ') %>%
  kable_styling(latex_options = c("striped",'HOLD_position'),full_width = TRUE)
tab_vento
```

Tirando o valor atípico, as medidas resumo dizem que a variável vt pode ser distribuídas uniformemente. 

## Exercício 7

Construa gráficos ramo-e-folhas e \textit{boxplot} para os dados do Exercício 6.

## Resolução

```{r,echo=FALSE,fig.width=4,fig.height=4}
library(ggplot2)
box_vento <- ggplot(dados_lista1_62,aes(y=vt)) + geom_boxplot() + ylab("Velocidade do Vento") + ggtitle("Boxplot da variável vt")
box_vento
steam_vento <- stem(sort(vt),scale=2)
```

## Exercício 12

Construa gráficos de quantis e simetria para os dados de manchas solares disponíveis no arquvio \textit{manchas}.


## Resolução

```{r,echo=FALSE,fig.width=4,fig.height=4}
library(xlsx)
library(ggplot2)
setwd("/home/emanuelhark/Documentos/Descritiva/Lista1")
dados_manchas <- read.xlsx('manchas2.xlsx',1)
dados_machas_2 <- dados_manchas[0:2]
df_manchas <- data.frame(dados_machas_2)
names(df_manchas) <- c('Ano','Ondas')
attach(df_manchas)
num <- 1/length(Ondas)
s <- seq.default(0,1,num)
plot(x=s,y = quantile(Ondas,seq.default(0,1,num)))
ondas <- Ondas
u1 = (ondas - 39.550)
v1 = (rev(ondas) - 39.550)
plot(u1[1:length(u1)/2],v1[1:length(v1)/2],xlab = "Dispersao inferior",ylab = "Dispersao Superior",abline(a=0,b=1))
```

## Exercício 15

Considere os valores $X_{1}$,...,$X_{n}$ de uma variável X, com média $\bar{X}$ e desvio padrão S. Mostre que a varíável Z, cujos valores são {$Z_{i}$ = ($X_{i}$-$X_{n}$)}{$S$}, i = 1,...,n tem média 0 e desvio padrão 1.

## Resolução

Fórmula da média: 
  $$\mu = \frac{1}{n}\sum_{i=1}^{n} X_i, i=1,...,n $$ 
  
Fórmuula da variância: 
  $$S^{2} = \frac{1}{n}\sum_{i=1}^{n} (x_i - \mu_x)^{2}, i=1,...,n $$ 
  
Fórmula do desvio padrão:
  $$S = \sqrt{S^{2}}$$

Calculando a média de Z:
  $$\mu_{Z} = \frac{1}{n}\sum_{i=1}^{n} (z_i) = \frac{1}{n}\sum_{i=1}^{n} (\frac{x_i - \mu_x}{s}) = \frac{1}{n_t s}\sum_{i=1}^{n}(x_i - \mu_x) =  \frac{1}{n s}((\sum_{i=1}^{n}x_i) - n\mu_x) = \frac{1}{ns}(n\mu_x-n\mu_x) = \frac{0}{ns} = 0$$
  
Calculando a variância de Z, e consequentemete, o desvio padrão:

$$S^{2} = \frac{1}{n}\sum_{i=1}^{n} (Z_i - \mu_z)^{2} = \frac{1}{n}\sum_{i=1}^{n} (Z_i)^2 = \frac{1}{n}\sum_{i=1}^{n}(\frac{x_i - \mu_x}{S})^{2} =  \frac{1}{nS^2}\sum_{i=1}^{n}(x_i - \mu_x)^2 = \frac{1}{nS^2}(nS^2) = 1$$

Então:
$$S^[2] = \sqrt{S^{2}_z} = \sqrt{1}  \implies S_z = 1 $$
  
## Exercício 25

Na tabela abaixo estão indicadas as durações de 335 lâmpadas.

\center
\begin{tabular}{cc}
\hline
Duração (horas) & Número de lâmpadas \\ \hline
  0 $\vdash $ 100 & 82 \\
100 $\vdash $ 200 & 71 \\
200 $\vdash $ 300 & 68 \\
300 $\vdash $ 400 & 56 \\
400 $\vdash $ 500 & 43 \\
500 $\vdash $ 800 & 15 \\ \hline
\end{tabular}

\raggedright

  a) Esboce o histograma correspondente.   \newline
  b) Calcule os quantis de ordem p=0,1. 0,3, 0,5, 0,7 e 0,9.   \newline
  
## Resolução 

a)

\center

```{r,echo=FALSE,fig.height=4,fig.width=4}
library(ggplot2)
classes_25 <- c(82,71,68,56,43,15)
pesos_25 <- c(0,100,200,300,400,500,800)
dados_25 <- c()
indica_peso <- 1
total_classe <- 1
total <- 0
for (indica_classe in classes_25){
    dados_25 <- c(dados_25,pesos_25[indica_peso])
    somadinha <- (pesos_25[indica_peso + 1] -pesos_25[indica_peso])/indica_classe
    while(total_classe < indica_classe){
    dados_25 <- c(dados_25,dados_25[total+total_classe] + somadinha)
    total_classe <- total_classe + 1
    }
    indica_peso <- indica_peso + 1
    total_classe <- 1
    total <- total + classes_25[indica_peso-1]
}
df_25 <- data.frame(dados_25)
histograma_25 <- ggplot(df_25,aes(x=dados_25)) + geom_histogram(bins=10,breaks=pesos_25,fill=I("blue")) 
histograma_25
```

\raggedright


b)

\center

```{r,echo=FALSE,fig.height=6,fig.width=6}
plot(x=seq.default(0,1,0.1),y=quantile(dados_25,seq.default(0,1,0.1)),xlab="Quantis de ordem p=0.1",ylab="Quantis da variável Número de Lâmpadas na ordem p=0,1")
plot(x=seq.default(0,1,0.3),y=quantile(dados_25,seq.default(0,1,0.3)),xlab="Quantis de ordem p=0.3",ylab="Quantis da variável Número de Lâmpadas na ordem p=0,3")
plot(x=seq.default(0,1,0.7),y=quantile(dados_25,seq.default(0,1,0.7)),xlab="Quantis de ordem p=0.7",ylab="Quantis da variável Número de Lâmpadas na ordem p=0,7")
plot(x=seq.default(0,1,0.9),y=quantile(dados_25,seq.default(0,1,0.9)),xlab="Quantis de ordem p=0.9",ylab="Quantis da variável Número de Lâmpadas na ordem p=0,9")
```

\raggedright



## Exercício 17

Os dados apresentados na figura abaixo referem-se aos instantes nos quais o centro de controle operacional de estradas rodoviárias recebeu chamados solicitando algum tipo de auxílio em duas estradas num determinado dia.

\center
\begin{tabular}{|c | c | c | c | c | c|} \hline
\hline
Estadra 1 & 12:07:00 AM & 12:58:00 AM & 01:24:00 AM & 01:35:00 AM & 02:05:00 AM \\ \hline
 & 03:14:00 AM & 03:25:00 AM & 03:46:00 AM & 05:44:00 AM & 05:56:00 AM \\ \hline
 & 06:36:00 AM & 07:26:00 AM & 07:48:00 AM & 09:13:00 AM & 12:05:00 PM \\ \hline
 & 12:48:00 PM & 01:21:00 PM & 02:22:00 PM & 05:30:00 PM & 06:00:00 PM \\ \hline
 & 07:53:00 PM & 09:15:00 PM & 09:49:00 PM & 09:59:00 PM & 10:53:00 PM \\ \hline
 & 11:27:00 PM & 11:49:00 PM & 11:57:00 PM & & \\ \hline
 Estrada 2 & 12:03:00 AM & 01:18:00 AM & 04:35:00 AM & 06:13:00 AM & 06:59:00 AM \\ \hline
 & 08:03:00 AM & 10:07:00 AM & 12:24:00 AM & 01:45:00 PM & 02:07:00 PM \\ \hline
 & 03:23:00 PM & 06:34:00 PM & 07:19:00 PM & 09:44:00 PM & 10:27:00 PM \\ \hline
 & 10:52:00 PM & 11:19:00 PM & 11:29:00 PM & 11:44:00 PM & \\ \hline
\end{tabular}
\raggedright
  a) Construa um histograma para a distribuição de frequências de chamados em cada uma das estrelas.   \newline
  b) Calcule os intervalos de tempo entre as sucessivas chamadas e descreva-os, para cada uma das estradas, utilizando medidas resumo gráficos do tipo \textit{boxplot}. Existe alguma   relação entre o tipo de estrada e o intervalo de tempo entre as chamadas ?   \newline
  c) Por intermédio de um gráfico do tipo QQ, verifique se a distribuição da variável "Intervalo de tempo entre as chamadas" em cada estrada é compátivel com um modelo Normal. Faça o   mesmo para um modelo exponencial. Compare as distribuições de frequências correspondentes às duas estradas.   \newline

## Resolução

```{python,echo=FALSE,warning=FALSE}
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
dt = pd.read_csv('Dados questão 17.csv', sep = ';')
```

```{python,echo=FALSE,warning=FALSE}
def hours_round(hour):
    lista = hour.split(':')
    hora = int(lista[0])
        
    return hora
```
a)
```{python,echo=FALSE,warning=FALSE}
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
dt = pd.read_csv('Dados questão 17.csv', sep = ';')

plt.figure( figsize = (12,6))
plt.xlabel('Horas', {'fontsize': 14})
plt.ylabel('Frequência', {'fontsize': 14})
plt.title('Chamados recebidos - estrada 1', {'fontsize': 16})
sns.distplot(dt['Estrada 1'].apply(hours_round), bins = [0,4,8,12,16,20,24], axlabel = 'Hora', kde = False, color = 'mediumblue')
plt.show()

estrada2 = dt.dropna()
estrada2 = estrada2['Estrada 2']

plt.figure( figsize = (12,6))
plt.xlabel('Horas', {'fontsize': 14})
plt.ylabel('Frequência', {'fontsize': 14})
plt.title('Chamados recebidos - estrada 2', {'fontsize': 16})
sns.distplot(estrada2.apply(hours_round), bins = [0,4,8,12,16,20,24], axlabel = 'Hora', kde = False, color = 'mediumblue')
plt.show()

```

b)
```{python,echo=FALSE,warning=FALSE}
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
dt = pd.read_csv('Dados questão 17.csv', sep = ';')
estrada2 = dt.dropna()
def hours_to_min(hour):
    hora = hour.split(':')
    minute = int(hora[0])*60 + int(hora[1])
    return minute
    
min_est1 = dt['Estrada 1'].apply(hours_to_min)

lista = []
for i in range(27):
    dif = min_est1[i+1] - min_est1[i]
    lista.append(dif)
    
intervalo_est1 = pd.DataFrame(lista, columns=['Intervalo'])

min_est2 = dt.dropna()['Estrada 2'].apply(hours_to_min)

lista2 = []
for i in range(17):
    dif = min_est2[i+1] - min_est2[i]
    lista2.append(dif)
    
intervalo_est2 = pd.DataFrame(lista2, columns=['Intervalo'])
```

\begin{table}[h]
    \centering
    \caption{Mediadas resumo e de dispersão das variáveis Estrada 1 e Estrada}
    \begin{tabular}{ m{4em} m{1em}  m{3em} m{5em}  m{3em} m{3em}  m{5em} m{3em}  m{3em}}
        \hline
        Estrada & N & Mínimo & 1º Quartil & Mediana & Média & 3º Quartil & Máximo & Desvio Padrão \\ \hline
        1 & 27 & 8 & 22 & 34 & 53 & 65 & 188 & 47 \\
        2 & 17 & 10 & 43 & 75 & 83 & 124 & 197 & 58\\ \hline
    \end{tabular}
\end{table}
    
\begin{table}[h]
    \centering
    \caption{ Rótulo das mediadas resumo e de dispersão das variáveis Estrada 1 e Estrada 2}
    \begin{tabular}{rrc}
        \hline
        Rótulo & Descrição & Unidade de medida \\ \hline
        Estrada & Estrada estudada &  \\
        N & Quantidade da amostra &  \\ 
        Mínimo & Valor mínimo da amostra &  min\\
        1º Quartil & 1º Quartil da amostra & min \\
        Mediana & Mediana da amostra &  min\\
        Média & Média da amostra &  min\\
        3º Quartil & 3º Quartil da amostra &  min\\
        Máximo & Valor máximo da amostra &  min\\
        Desvio & Desvio padrão da amostra &  min\\
        \hline
    \end{tabular}
\end{table}

\raggedright


```{python,echo=FALSE,warning=FALSE}
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
dt = pd.read_csv('Dados questão 17.csv', sep = ';')
estrada2 = dt.dropna()
def hours_to_min(hour):
    hora = hour.split(':')
    minute = int(hora[0])*60 + int(hora[1])
    return minute
    
min_est1 = dt['Estrada 1'].apply(hours_to_min)

lista = []
for i in range(27):
    dif = min_est1[i+1] - min_est1[i]
    lista.append(dif)
    
intervalo_est1 = pd.DataFrame(lista, columns=['Intervalo'])

min_est2 = dt.dropna()['Estrada 2'].apply(hours_to_min)

lista2 = []
for i in range(17):
    dif = min_est2[i+1] - min_est2[i]
    lista2.append(dif)
    
intervalo_est2 = pd.DataFrame(lista2, columns=['Intervalo'])

plt.figure(figsize=(5,5))
sns.boxplot(y = 'Intervalo',data= intervalo_est1)
plt.tick_params(labelsize = 12)
plt.ylabel('Intervalo (minutos)', {'fontsize': 14})
plt.title('Intervalo entre chamados - estrada 1', {'fontsize': 16})
plt.show()


plt.figure(figsize=(5,5))
sns.boxplot(y = 'Intervalo', data= intervalo_est2)
plt.tick_params(labelsize = 12)
plt.ylabel('Intervalo (minutos)', {'fontsize': 14})
plt.title('Intervalo entre chamadas - estrada 2', {'fontsize': 16})
plt.show()

```

Com base nos boxplots e nas medidas descritivas,que foram transformadas da unidade hora para a unidade minuto, podemos observar que existe uma relação entre o intervalo de chamadas e o tipo de estrada, pois vemos que, na estrada 1, os intervalos entre chamadas são mais baixos que os da entrada 2, analisando de forma geral.

c)

```{python,echo=FALSE,warning=FALSE}
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
import statsmodels.api as sm
import scipy.stats as stats
dt = pd.read_csv('Dados questão 17.csv', sep = ';')
estrada2 = dt.dropna()
def hours_to_min(hour):
    hora = hour.split(':')
    minute = int(hora[0])*60 + int(hora[1])
    return minute
    
min_est1 = dt['Estrada 1'].apply(hours_to_min)

lista = []
for i in range(27):
    dif = min_est1[i+1] - min_est1[i]
    lista.append(dif)
    
intervalo_est1 = pd.DataFrame(lista, columns=['Intervalo'])

min_est2 = dt.dropna()['Estrada 2'].apply(hours_to_min)

lista2 = []
for i in range(17):
    dif = min_est2[i+1] - min_est2[i]
    lista2.append(dif)
    
intervalo_est2 = pd.DataFrame(lista2, columns=['Intervalo'])
media = intervalo_est1['Intervalo'].mean()
s = intervalo_est1['Intervalo'].std()
normalizados1 = intervalo_est1['Intervalo'].apply(lambda x: (x-media)/s)

figure, ax = plt.subplots(figsize=(12,8))
ax.tick_params(labelsize = 12)
ax.set_title('QQplot dos intervalos de chamadas - estrada 1', fontdict={'fontsize': 16})
sm.qqplot(data=normalizados1.sort_values(), a=0.5, loc=0, scale=1, line = '45', ax = ax)
ax.set_xlabel('Quantis teóricos da distribuição normal', fontdict={'fontsize': 14})
ax.set_ylabel('Quantis amostrais', fontdict={'fontsize': 14})
plt.show()


media = intervalo_est2['Intervalo'].mean()
s = intervalo_est2['Intervalo'].std()
normalizados2 = intervalo_est2['Intervalo'].apply(lambda x: (x-media)/s)
figure, ax = plt.subplots(figsize=(12,8))
ax.tick_params(labelsize = 12)
ax.set_title('QQplot dos intervalos de chamadas - estrada 2', fontdict={'fontsize': 16})
sm.qqplot(data=normalizados2.sort_values(), a=0.5, loc=0, scale=1, line = '45', ax = ax)
ax.set_xlabel('Quantis teóricos da distribuição normal', fontdict={'fontsize': 14})
ax.set_ylabel('Quantis amostrais', fontdict={'fontsize': 14})
plt.show()

figure, ax = plt.subplots(figsize=(12,8))
ax.tick_params(labelsize = 12)
ax.set_title('QQplot dos intervalos de chamadas - estrada 1', fontdict={'fontsize': 16})
sm.qqplot(data=normalizados1.sort_values(), dist=stats._continuous_distns.expon, a=0.5, fit=True, line = '45', ax = ax)
ax.set_xlabel('Quantis teóricos da distribuição exponencial', fontdict={'fontsize': 14})
ax.set_ylabel('Quantis amostrais', fontdict={'fontsize': 14})
plt.show()


figure, ax = plt.subplots(figsize=(12,8))
ax.tick_params(labelsize = 12)
ax.set_title('QQplot dos intervalos de chamadas - estrada 2', fontdict={'fontsize': 16})
sm.qqplot(data=normalizados2.sort_values(), dist=stats._continuous_distns.expon, a=0.5, fit=True, line = '45', ax = ax)
ax.set_xlabel('Quantis teóricos da distribuição exponencial', fontdict={'fontsize': 14})
ax.set_ylabel('Quantis amostrais', fontdict={'fontsize': 14})
plt.show()

```

Com base nos gráficos QQ, vemos que a distribuição dos intervalo entre chamadas sucessivas da estrada 1 se ajusta melhor a distribuição exponencial do que a distribuição normal. Já os dados da estrada 2 não se ajustam bem a nenhuma das distribuições, entretanto tem ajuste melhor a distribuição normal se comparado com a dos dados da estrada 1.
Ao comparar as duas distribuições pelo qqplot, podemos dizer que as duas distribuições são, de fato, diferentes.

## Exercício 18

As notas finais de um curso de Estatística foram: 7,5,4,5,6,3,8,4,5,4,6,4,5,6,4,6,6,3,8,4,5,4,5,5 e 6.

  a) Determine a mediana, os quartis e a média.   \newline
  b) Separe o conjunto de dados em dois grupos denominados \textbf{aprovados}, com nota pelo menos igual a 5, e \textbf{reprovados}. Compare a variância desses dois grupos.   \newline
  
## Resolução

a)
  
```{r,echo=FALSE}
library(knitr)
library(magrittr)
library(kableExtra)

dados <- c(7, 5, 4, 5, 6, 3, 8, 4, 5, 4, 6, 4, 5, 6, 4, 6, 6, 3, 8, 4, 5, 4, 5, 5, 6)
media <- mean(dados)
quantis <- quantile(dados)
quartil <- quantis[1]
mediana <- quantis[2]
quartilu <- quantis[3]
names(media) = c('Média')
names(quantis) = c('Mínimo','1º Quartil','Mediana','3º Quartil','Máximo')
data_18 <- data.frame(media,quartil,mediana,quartilu)
names(data_18) <- c('Média','1º Quartil','Mediana','3º Quartil')
tabela <- kable(data_18,booktabs=T) %>%
   kable_styling(latex_options = 'striped')
tabela
```

b)
```{r,echo=FALSE}

dados_25_2 <- c(7, 5, 4, 5, 6, 3, 8, 4, 5, 4, 6, 4, 5, 6, 4, 6, 6, 3, 8, 4, 5, 4, 5, 5, 6)
aprovados<- c()
reprovados <- c()
indicado <- 0
for (indicado in dados_25_2){
  if (!indicado < 5){
    reprovados <- c(reprovados,indicado)
  }else{
    aprovados <- c(aprovados,indicado)
  }
}
var_aprovados <- var(aprovados)
var_reprovados <- var(reprovados)

df_18_2 <- data.frame('Variância',var_aprovados,var_reprovados)
names(df_18_2) <- c('','Aprovados','Reprovados')
tabela_18 <- kable(df_18_2,booktabs=T) %>%
   kable_styling(latex_options = c("striped",'HOLD_position'),full_width = TRUE) %>%
  add_header_above(c('','Alunos'=2)) 
tabela_18
```


## Exercício 28

Os dados encontrados no arquivo \textit{esforco} são provenientes de um estudo sobre teste de esforço cardiopulmonar em pacientes com insuficiência cardı́aca. As variáveis medidas durante a realização do teste foram observadas em quatro momentos distintos: repouso (REP), limiar anaeróbio (LAN), ponto de compensação respiratório (PCR) epico (PICO). As demais variáveis são referentes às caracterı́sticas demográficas e clı́nicas dos pacientes e foram registradas uma única vez.  \newline

  a) Descreva a distribuição da variável consumo de oxigênio (VO2) em cada um dos quatro momentos de avaliação utilizando medidas resumo (mı́nimo, máximo, quartis, mediana, média,     desvio padrão, etc), \textit{boxplots} e histogramas. Você identifica algum paciente com valores de consumo de oxigênio discrepantes? Interprete os resultados.   \newline
  b) Descreva a distribuição da classe funcional NYHA por meio de uma tabela de frequências. Utilize um método gráfico para representar essa tabela.    \newline
  
## Resolução

a)

\begin{table}[h]
    \centering
    \caption{Medidas resuno e de dispersão das variáveis Repouso, LAN, PCR e PCIO, em $\frac{ml}{kg \cdot min}$.}
    \begin{tabular}{  m{4em} m{1em}  m{3em} m{5em}  m{3em} m{3em}  m{5em} m{3em}  m{3em}}
        \hline
        Variáveis & N & Mínimo  & 1º Quartil & Mediana  & Média  & 3º Quartil & Máximo  & Desvio Padrão   \\ \hline
        Repouso & 127 & 1.7 & 3.0 & 3.4 & 3.6 & 4.0 & 6.4 & 0.8 \\ 
        LAN & 124 & 5.1 & 8.6 & 10.0 & 10.5 & 11.7 & 21.4 & 2.8 \\
        PCR & 121 & 6.9 & 11.3 & 13.9 & 14.8 & 16.6 & 29.8 & 4.7 \\
        PICO & 127 & 5.2 & 13.5 & 17.1 & 18.1 & 21.0 & 41.0 & 6.5 \\ \hline
    \end{tabular}
\end{table}

\begin{table}[h]
    \centering
    \caption{ Rótulo das mediadas resumo e de dispersão das variáveis Estrada 1 e Estrada 2}
    \begin{tabular}{crc}
        \hline
        Rótulo & Descrição & Unidade de medida \\ \hline
        Variável & Variável estudada da variável &  \\
        N & Quantidade da amostra da variável &  \\ 
        Mínimo & Valor mínimo da amostra da variável &  $\frac{ml}{kg \cdot min}$ \\
        1º Quartil & 1º Quartil da amostra da variável & $\frac{ml}{kg \cdot min}$ \\
        Mediana & Mediana da amostra da variável &  $\frac{ml}{kg \cdot min}$ \\
        Média & Média da amostra da variável &  $\frac{ml}{kg \cdot min}$ \\
        3º Quartil & 3º Quartil da amostra da variável &  $\frac{ml}{kg \cdot min}$ \\
        Máximo & Valor máximo da amostra da variável &  $\frac{ml}{kg \cdot min}$ \\
        Desvio & Desvio padrão da amostra da variável &  $\frac{ml}{kg \cdot min}$ \\
        \hline
    \end{tabular}
    \end{table}

\raggedright

```{python,echo=FALSE,warning=FALSE}
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd
dataset_12 = pd.read_csv("esforco.csv", sep = ',')
plt.figure(figsize=(6,6))
sns.boxplot(y = 'Repouso', data= dataset_12)
plt.tick_params(labelsize = 12)
plt.ylabel('Consumo de Oxigênio (ml/(kg.min))', {'fontsize': 14})
plt.title('Consumo de oxigênio em momento de repouso', {'fontsize':16})
plt.show()

plt.figure(figsize=(6,6))
sns.boxplot(y = 'LAN', data= dataset_12)
plt.tick_params(labelsize = 12)
plt.ylabel('Consumo de Oxigênio (ml/(kg.min))', {'fontsize': 14})
plt.title('Consumo de oxigênio em momento de limiar anaeróbio', {'fontsize':16})
plt.show()

plt.figure(figsize=(6,6))
sns.boxplot(y = 'PCR', data= dataset_12)
plt.tick_params(labelsize = 12)
plt.ylabel('Consumo de Oxigênio (ml/(kg.min))', {'fontsize': 14})
plt.title('Consumo de oxigênio em ponto de compensação respiratória', {'fontsize':15})
plt.show()

plt.figure(figsize=(6,6))
sns.boxplot(y = 'PICO', data= dataset_12)
plt.tick_params(labelsize = 12)
plt.ylabel('Consumo de Oxigênio (ml/(kg.min))', {'fontsize': 14})
plt.title('Consumo de oxigênio em momento de Pico', {'fontsize':16})
plt.show()

plt.figure( figsize = (8,6))
plt.ylabel('Frequência', {'fontsize': 14})
plt.title('Consumo de oxigênio em momento de repouso', {'fontsize': 16})
sns.distplot(dataset_12['Repouso'], kde = False, color = 'mediumblue', bins = np.arange(1,7,0.4))
plt.xlabel('Consumo de oxigênio (ml/(kg.min))', {'fontsize': 14})
plt.show()

plt.figure( figsize = (8,6))
plt.ylabel('Frequência', {'fontsize': 14})
plt.title('Consumo de oxigênio em momento de limiar anaeróbio', {'fontsize': 16})
sns.distplot(dataset_12['LAN'].dropna(), kde = False, color = 'mediumblue', bins = np.arange(5,23,1.2))
plt.xlabel('Consumo de oxigênio (ml/(kg.min))', {'fontsize': 14})
plt.show()

plt.figure( figsize = (12,6))
plt.ylabel('Frequência', {'fontsize': 14})
plt.title('Consumo de oxigênio em ponto de compensação respiratória', {'fontsize': 16})
sns.distplot(dataset_12['PCR'].dropna(), kde = False, color = 'mediumblue', bins = np.arange(6,30,1.6))
plt.xlabel('Consumo de oxigênio (ml/(kg.min))', {'fontsize': 14})
plt.show()

plt.figure( figsize = (12,6))
plt.ylabel('Frequência', {'fontsize': 14})
plt.title('Consumo de oxigênio em momento de pico', {'fontsize': 16})
sns.distplot(dataset_12['PICO'], kde = False, color = 'mediumblue', bins = np.arange(5,44,2.4))
plt.xlabel('Consumo de oxigênio (ml/(kg.min))', {'fontsize': 14})
plt.show()

```

Podemos identificar algumas medidas discrepantes nos quatro gráficos boxplot. Além disso, notamos que a distribuição do consumo de oxigênio é semelhante nos quatro momentos em que foi medido, o consumo de oxigênio tende a subir de acordo com momento, sendo o Picoo momento com valores mais altos e Repouso o com valores mais baixos. 

b)

\begin{table}[h]
    \centering
    \caption{Distribuição de frequência do número de pacientes da variável NYHA}
    \begin{tabular}{  m{5em} m{4em}  m{6em} m{4em}  m{5em}}
        \hline
        Classe Funcional NYHA & Frequência & Frequência acumulada & Frequência relativa (\%) & Frequência relativa acumulada (\%) \\ \hline
        1 & 27 & 27 & 31 & 31 \\
        2 & 23 & 50 & 26 & 57 \\
        3 & 24 & 74 & 28 & 85 \\
        4 & 13 & 87 & 15 & 100 \\ \hline
        Total & 87 & 67 & 100 & 100 \\ \hline
    \end{tabular}
\end{table}


\raggedright

```{python,echo=FALSE,warning=FALSE}
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd
import xlrd 
NYHA = pd.read_csv('nam.csv',sep=";")

datat = NYHA[NYHA['NYHA'] != 0]
plt.figure(figsize=(10,6))
ax = sns.countplot(x='NYHA', data=datat)
plt.ylabel('Contagem', fontdict = {'fontsize':14})
plt.tick_params(labelsize = 12)
plt.title('Número de pacientes em cada classe funcional', fontdict = {'fontsize': 16})

for p in ax.patches:
    ax.annotate('{}'.format(p.get_height()), (p.get_x()+0.35, p.get_height()+0.3))
plt.show()
```

## Exercício 32

Considere uma amostra aleatória simples $X_{1}$,...,$X_{n}$ de uma variável X que asssume o valor 1 com probabilidade 0 < p < 1 e o valor 0 com probabilidade 1- p. Seja $\hat{p}$ = $n^{-1}$ $\sum_{i=1}^{n} X_i$. Mostre que   \newline
    i) E($X_{i}$) = p e Var($X_{i}$) = p(1-p).   \newline
    ii) E($\hat{p}$) = p e Var($\hat{p}$) = p(1-p)/n.   \newline
    iii) 0 <  Var($X_{i}$) < 0,25.   \newline
Com base nesses resultados, utilize o Teorema Limite Central [ver Sen et al. (2009), por exemplo] para construir um intervalo de confiança aproximado conservador (i.e. com a maior amplitude possı́vel) para p. Utilize o Teorema de Sverdrup [ver Sen et al. (2009), por exemplo] para construir um intervalo de confiança aproximado para p com amplitude menor que a do intervalo mencionado acima.

## Resolução

i)
$$E(x) = 0\cdot(1-p) + 1\cdot p = p$$
$$Var(x) = E(x^{2}) - [E(x)]^{2} = (0^2 \cdot (1-p) + 1 \cdot 1) - p^{2} = p - p^{2} = p \cdot(1-p)$$

ou

$$Var(x) = (0 \cdot p) \cdot (1-p) + (1-p)^2 \cdot p = p^{2} \cdot (1-p)  + (1-p)^2 \cdot p = p \cdot (1-p) \cdot [p + (1-p)] = p \cdot (1-p)$$

ii)
$$E(\hat{p}) = E(\frac{1}{n}\sum_{i=n}^{n} (X_i)) = \frac{1}{n} \cdot E(\sum_{i=n}^{n} X_i)  = \frac{n \cdot p}{n} = p$$

$$Var(\hat{p}) = Var(\frac{1}{n}\sum_{i=n}^{n} (X_i)) = \frac{1}{n^{2}} \cdot E(\sum_{i=n}^{n} X_i)  = \frac{n \cdot p \cdot (1-p)}{n^{2}} = \frac{p \cdot (1-p)}{n}$$

iii)
$$ \frac{\partial}{\partial p} \cdot p \cdot (1-p) = 1 - 2\cdot p = 0 \Rightarrow p = \frac{1}{2}$$

Logo, a variância máxima é atinginda quando $$p = \frac{1}{2}$$, então $$\frac{1}{2}\cdot(1-\frac{1}{2}) = \frac{1}{4}$$.

A variância é mínima quando $p = 0$, então $$0\cdot(1-0) = 0$$.

Portanto, $$ 0 < Var(X) < 0.25$$.


$$\hat{p} \sim N\left(\hat{p},\frac{\hat{p}\cdot(1-\hat{p})}{n}\right) $$

$$  \mathcal{P}\left(-Z_\gamma < \frac{\hat{p} - p}{\sqrt{\frac{\hat{p}\cdot(1-\hat{p}}{n}}}\right) = \mathcal{P}\left(-Z_\gamma\cdot\sqrt{\frac{\hat{p}\cdot(1-\hat{p}}{n}} < \hat{p} - p < Z_\gamma\cdot\sqrt{\frac{\hat{p}\cdot(1-\hat{p}}{n}}\right) =$$
$$\mathcal{P}\left(-\hat{p}-Z_\gamma\cdot{\sqrt{\frac{\hat{p}\cdot(1-\hat{p}}{n}}} < - p < \hat{p} + Z_\gamma\cdot \sqrt{\frac{\hat{p}\cdot(1-\hat{p}}{n}}\right) = \mathcal{P}\left(\hat{p}-Z_\gamma\cdot\sqrt{\frac{\hat{p}\cdot(1-\hat{p}}{n}} < - p < \hat{p} + Z_\gamma\cdot\sqrt{\frac{\hat{p}\cdot(1-\hat{p}}{n}}\right) $$

Intervalo de confiança aproximadamente conservador ($\hat{p}\cdot(1-\hat{p}) = \frac{1}{4}$))

$$IC(p,\gamma) = \left[\hat{p} \pm Z_\gamma\cdot \sqrt{\frac{1}{4\cdot n}}\right] = \left[\hat{p} \pm \frac{Z_\gamma}{2 \cdot \sqrt{n}}\right] $$

Intervalo de confiança aproximado para p com amplitude menor

$$IC(p,\gamma) = \left[\hat{p} \pm Z_\gamma\cdot \sqrt{\frac{\hat{p}\cdot(1-\hat{p})}{n}}\right]  $$

